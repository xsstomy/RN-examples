var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var Anim=function(e){function t(t,i){void 0===i&&(i=null),e.call(this),this.name="",this.positionX=1992,this.positionY=246,this.moveClipInfos=[{x:0,y:0,name:""}],this.info={mvName:"one",pngName:"showone1_png",x:1228,y:63,points:{one:{x:1396,y:216},two:{x:1672,y:216},three:{x:1396,y:452},four:{x:1672,y:452}}},this.startX=0,this.startY=0,this.preX=0,this.preY=0,this.info=t,this.viewManager=i,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.init=function(){this.resetPosition(),this.bitmap=new egret.Bitmap(RES.getRes(this.info.pngName)),this.addChild(this.bitmap);var e="move"+this.info.mvName+"_json",t="move"+this.info.mvName+"_png",i=RES.getRes(e),n=RES.getRes(t),s=new egret.MovieClipDataFactory(i,n);this.movie=new egret.MovieClip(s.generateMovieClipData("movie")),this.audio=new AudioPlayer("right_mp3")},n.reset=function(){this.resetPosition()},n.initListeners=function(){var e=this;this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.isHitTarget()?(e.touchEnabled=!1,e.playSuccAnim(),e.playSuccAudio()):e.reset()},this)},n.removeListeners=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},n.resetPosition=function(){"one"===this.info.mvName?(this.x=this.positionX-50,this.y=this.positionY-50):(this.x=this.positionX,this.y=this.positionY)},n.onTouchBegin=function(e){this.startX=e.stageX,this.startY=e.stageY,this.preX=e.stageX,this.preY=e.stageY,this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},n.onTouchMove=function(e){var t=e.stageX-this.preX,i=e.stageY-this.preY;this.x+=2698*t/1280,this.y+=1716*i/720,this.preX=e.stageX,this.preY=e.stageY},n.onTouchEnd=function(e){this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.isHitTarget()?(this.touchEnabled=!1,this.playSuccAnim(),this.playSuccAudio()):this.reset()},n.onAdded=function(){this.init(),this.initListeners()},n.onRemoved=function(){this.removeListeners(),this.reset()},n.playSuccAnim=function(){this.movie.gotoAndPlay("play",6),this.movie.scaleX=this.movie.scaleY=2,this.x=this.info.x,this.y=this.info.y,this.addChild(this.movie),this.movie.addEventListener(egret.Event.COMPLETE,this.mvCompletePlayed,this)},n.playSuccAudio=function(){this.audio.play(1)},n.mvCompletePlayed=function(){this.movie.removeEventListener(egret.Event.COMPLETE,this.mvCompletePlayed,this);var e=new ChangeEvent(ChangeEvent.ChangeEvent);e.eventType=ChangeEvent.PlayTransitionMv,this.viewManager.dispatchEvent(e)},n.isHitTarget=function(){var e=this.info.points,t=this.x,i=this.y,n=2*this.movie.width,s=2*this.movie.height;return t<=e.one.x&&i<=e.one.y&&t+n>=e.two.x&&i<=e.two.y&&t<e.three.x&&i+s>=e.three.y&&t+n>=e.four.x&&i+s>=e.four.y?!0:!1},t}(egret.Sprite);egret.registerClass(Anim,"Anim");var AudioPlayer=function(){function e(e,t){void 0===t&&(t=!0),this._name=null,this._isEffect=null,this.channel=null,this.isPlaying=!1,this._name=e,this._isEffect=t,this.init()}var t=(__define,e),i=t.prototype;return i.init=function(){this.sound=RES.getRes(this._name),this._isEffect?this.sound.type=egret.Sound.EFFECT:this.sound.type=egret.Sound.MUSIC},i.getPlayState=function(){return this.isPlaying},i.play=function(e){void 0===e&&(e=0),this.channel=this.sound.play(0,e),this.channel.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundCompl,this),this.isPlaying=!0},i.onSoundCompl=function(){this.channel&&(this.channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundCompl,this),this.isPlaying=!1)},i.stop=function(){this.channel.stop(),this.channel.position=0,this.channel=null},i.reStart=function(){},i.updateVolume=function(e){var t=0;e>=0&&1>=e?t=e:0>e?t=0:e>1&&(t=1),this.channel.volume=t},e}();egret.registerClass(AudioPlayer,"AudioPlayer");var ChangeEvent=function(e){function t(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),e.call(this,t,i,n),this.eventType=""}__extends(t,e);var i=(__define,t);i.prototype;return t.ChangeEvent="ChangeEvent",t.PlayTransitionMv="PlayTransitionMv",t.StartGame="StartGame",t.PlayAgain="PlayAgain",t.InitStage="InitStage",t.PlayTransiVideo="PlayTransiVideo",t}(egret.Event);egret.registerClass(ChangeEvent,"ChangeEvent");var FishLoading=function(e){function t(t){e.call(this),this.skinName="fishLoading",this.viewManager=t,this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onHandleAdded,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHandleRemoved,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.init=function(){var e="fingerLoading_json",t="fingerLoading_png",i=RES.getRes(e),n=RES.getRes(t),s=new egret.MovieClipDataFactory(i,n);this.movie=new egret.MovieClip(s.generateMovieClipData("movie")),this.movie.gotoAndPlay("play",-1),this.movie.x=1368,this.movie.y=280,this.noticeAudio=new AudioPlayer("notice_mp3")},n.createChildren=function(){e.prototype.createChildren.call(this)},n.childrenCreate=function(){},n.onHandleAdded=function(){this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartGame,this),this.noticeAudio.play(1),this.addChild(this.movie)},n.onHandleRemoved=function(){this.removeChild(this.movie),this.noticeAudio.stop(),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartGame,this)},n.onStartGame=function(){var e=new ChangeEvent(ChangeEvent.ChangeEvent);e.eventType=ChangeEvent.StartGame,this.viewManager.dispatchEvent(e)},t}(eui.Component);egret.registerClass(FishLoading,"FishLoading");var GameOver=function(e){function t(t){e.call(this),this.skinName="gameOver",this.viewManager=t,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onHandleAdded,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHandleRemoved,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.onHandleAdded=function(){this.playAgainBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayAgain,this),this.greateAudio=new AudioPlayer("youaregreate_mp3"),this.greateAudio.play(1)},n.onHandleRemoved=function(){this.playAgainBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayAgain,this)},n.onPlayAgain=function(){var e=new ChangeEvent(ChangeEvent.ChangeEvent);e.eventType=ChangeEvent.PlayAgain,this.viewManager.dispatchEvent(e)},t}(eui.Component);egret.registerClass(GameOver,"GameOver");var GameStage=function(e){function t(){e.call(this),this.screens=[0,1,2,3],this.infos=[{mvName:"one",pngName:"showone1_png",x:1228,y:63,points:{one:{x:1396,y:216},two:{x:1672,y:216},three:{x:1396,y:452},four:{x:1672,y:452}}},{mvName:"two",pngName:"showtwo1_png",x:688,y:363,points:{one:{x:784,y:452},two:{x:1080,y:452},three:{x:784,y:700},four:{x:1080,y:700}}},{mvName:"three",pngName:"showthree1_png",x:960,y:847,points:{one:{x:1080,y:956},two:{x:1396,y:956},three:{x:1080,y:1200},four:{x:1396,y:1200}}},{mvName:"four",pngName:"showfour1_png",x:72,y:603,points:{one:{x:180,y:700},two:{x:488,y:700},three:{x:180,y:950},four:{x:488,y:950}}}],this.skinName="playStage",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onHandleAdded,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHandleRemoved,this),this.addEventListener(ChangeEvent.ChangeEvent,this.onChangeEvent,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this)},n.childrenCreated=function(){this.noticeAudio=new AudioPlayer("notice_mp3"),this.audioBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayNoticeAudio,this)},n.onPlayNoticeAudio=function(){this.noticeAudio.getPlayState()||this.noticeAudio.play(1)},n.onHandleAdded=function(){this.onNextScreen();var e="mLogoPerson_json",t="mLogoPerson_png",i=RES.getRes(e),n=RES.getRes(t),s=new egret.MovieClipDataFactory(i,n);this.mvLogoPerson=new egret.MovieClip(s.generateMovieClipData("movie")),this.mvLogoPerson.gotoAndPlay("play",-1),this.mvLogoPerson.scaleX=this.mvLogoPerson.scaleY=2,this.addChild(this.mvLogoPerson),this.mvLogoPerson.x=1815,this.mvLogoPerson.y=916,this.fishLoading=new FishLoading(this),this.gameOver=new GameOver(this),this.addChild(this.fishLoading)},n.onChangeEvent=function(e){switch(e.eventType){case ChangeEvent.PlayTransitionMv:this.playTransMv();break;case ChangeEvent.StartGame:this.onStartGame();break;case ChangeEvent.PlayAgain:this.onPlayAgain()}},n.onStartGame=function(){this.removeChild(this.fishLoading)},n.playTransMv=function(){var e="transition_json",t="transition_png",i=RES.getRes(e),n=RES.getRes(t),s=new egret.MovieClipDataFactory(i,n);this.mvTransition=new egret.MovieClip(s.generateMovieClipData("movie")),this.mvTransition.gotoAndPlay("play",1),this.mvTransition.scaleX=4.5,this.mvTransition.scaleY=5,this.addChild(this.mvTransition),this.mvTransition.addEventListener(egret.Event.COMPLETE,this.onTranComplete,this)},n.onTranComplete=function(){this.mvTransition.removeEventListener(egret.Event.COMPLETE,this.onTranComplete,this),this.removeChild(this.mvTransition),this.removeChild(this.anim),this.isGameOver()?this.onGameOver():this.onNextScreen()},n.onNextScreen=function(){var e=this.onRoundScreen();this.anim=new Anim(e,this),this.addChild(this.anim)},n.onRoundScreen=function(){var e=Math.floor(Math.random()*this.screens.length),t=JSON.parse(JSON.stringify(this.infos[this.screens[e]]));return this.screens.splice(e,1),t},n.isGameOver=function(){return this.screens.length<=0?!0:!1},n.onGameOver=function(){this.addChild(this.gameOver)},n.onPlayAgain=function(){this.resetData(),this.removeChild(this.gameOver)},n.resetData=function(){this.screens=[0,1,2,3],this.onNextScreen()},n.onHandleRemoved=function(){},t}(eui.Component);egret.registerClass(GameStage,"GameStage");var LoadingTransiMv=function(e){function t(t){e.call(this),this.tipStr="Loading...",this.viewManager=t,this.skinName="loadingTransiMv",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onHandleAdded,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHandleRemoved,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.onHandleAdded=function(){var e=this;this.loadingNoticeAudio=new AudioPlayer("loadingMp_mp3"),this.loadingNoticeAudio.play(1),this.loadingBg=new egret.Bitmap(RES.getRes("loadingBg_jpg")),this.addChild(this.loadingBg);var t="loadingMv_json",i="loadingMv_png",n=RES.getRes(t),s=RES.getRes(i),o=new egret.MovieClipDataFactory(n,s);this.loadingMv=new egret.MovieClip(o.generateMovieClipData("movie")),this.loadingMv.gotoAndPlay("play",3),this.addChild(this.loadingMv),this.loadingMv.addEventListener(egret.Event.COMPLETE,this.onComplete,this);var a='<e:Skin class="skins.ProgressBarSkin" minWidth="30" minHeight="18" xmlns:e="http://ns.egret.com/eui">\n            <e:Image source="progress_bar_bg_png" scale9Grid="1,1,4,4" width="100%"\n                    height="100%" verticalCenter="0"/>\n            <e:Image id="thumb" height="100%" width="100%" source="progress_bar_thumb_png"/>\n            <e:Label id="labelDisplay" textAlign="center" verticalAlign="middle"\n                    size="15" fontFamily="Tahoma" textColor="0xFFFFFF"\n                    horizontalCenter="0" verticalCenter="0"/>\n        </e:Skin>';this.progress=new eui.ProgressBar,this.progress.skinName=a,this.progress.x=400,this.progress.y=621,this.progress.labelFunction=function(t,i){return e.tipStr+(t+"/"+i)},this.addChild(this.progress)},n.onHandleRemoved=function(){},n.onComplete=function(){var e=new ChangeEvent(ChangeEvent.ChangeEvent);e.eventType=ChangeEvent.PlayTransiVideo,this.viewManager.dispatchEvent(e)},n.setProgress=function(e,t){this.progress.maximum=t,this.progress.value=e},t}(eui.Component);egret.registerClass(LoadingTransiMv,"LoadingTransiMv");var VideoPlayer=function(e){function t(t,i){e.call(this),this.times=0,this.videoName=t,this.listener=i,this.init()}__extends(t,e);var i=(__define,t),n=i.prototype;return n.init=function(){this.video=new egret.Video(this.videoName,!1),this.video.x=0,this.video.y=0,this.video.width=1280,this.video.height=720,this.video.fullscreen=!1,this.listener.addChild(this.video),this.video.play(0,!1),this.video.addEventListener(egret.Event.ENDED,this.onVideoPlayComp,this)},n.onVideoPlayComp=function(){if(this.times++,!(this.times>1)){this.video&&this.listener&&this.video.parent&&(this.listener.removeChild(this.video),this.video.close());var e=new ChangeEvent(ChangeEvent.ChangeEvent);e.eventType=ChangeEvent.InitStage,this.listener.dispatchEvent(e),console.log("COMPLETE")}},t}(egret.Sprite);egret.registerClass(VideoPlayer,"VideoPlayer");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createView=function(){},n.setProgress=function(e,t){},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),this.addEventListener(ChangeEvent.ChangeEvent,this.onChangeEvent,this)},n.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},n.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},n.onResourceLoadComplete=function(e){"loading"==e.groupName?(RES.loadGroup("preload"),this.loadingTransiMv=new LoadingTransiMv(this),this.addChild(this.loadingTransiMv)):"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},n.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},n.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},n.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},n.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingTransiMv.setProgress(e.itemsLoaded,e.itemsTotal)},n.startCreateScene=function(){},n.onChangeEvent=function(e){switch(e.eventType){case ChangeEvent.InitStage:this.addGameStage();break;case ChangeEvent.PlayTransiVideo:this.onPlayTransiVideo()}},n.addGameStage=function(){this.loadingTransiMv&&this.loadingTransiMv.parent&&this.loadingTransiMv.parent.removeChild(this.loadingTransiMv);var e=new GameStage;e.scaleX=1280/2698,e.scaleY=720/1716,this.addChild(e)},n.onPlayTransiVideo=function(){this.transiVideo=new VideoPlayer("resource/mp/loadingMv.mp4",this),this.bgAudio=new AudioPlayer("oceanBg_mp3",!1),this.bgAudio.play(),this.bgAudio.updateVolume(.1)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,n){function s(e){t.call(n,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);